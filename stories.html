<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Kids Fun Stories</title>
Â  Â  <script src="bundle.js"></script>
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --accent: #2e7d32;
Â  Â  Â  Â  Â  Â  --accent-light: #e8f5e9;
Â  Â  Â  Â  Â  Â  --bg: #f8f9fa;
Â  Â  Â  Â  Â  Â  --card: #ffffff;
Â  Â  Â  Â  Â  Â  --muted: #6c757d;
Â  Â  Â  Â  Â  Â  --border-color: #dee2e6;
Â  Â  Â  Â  }

Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  -webkit-tap-highlight-color: transparent;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  background: var(--bg);
Â  Â  Â  Â  Â  Â  color: #212529;
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  }

Â  Â  Â  Â  header {
Â  Â  Â  Â  Â  Â  background: var(--accent);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  main {
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  margin: 2rem auto;
Â  Â  Â  Â  Â  Â  padding: 0 1rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .controls-container {
Â  Â  Â  Â  Â  Â  background: var(--card);
Â  Â  Â  Â  Â  Â  padding: 1.5rem;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  margin-bottom: 2rem;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  }

Â  Â  Â  Â  .language-selector {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 1rem;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 1.5rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .lang-btn {
Â  Â  Â  Â  Â  Â  padding: 0.5rem 1rem;
Â  Â  Â  Â  Â  Â  border: 2px solid var(--accent);
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  color: var(--accent);
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .lang-btn.active, .lang-btn:hover {
Â  Â  Â  Â  Â  Â  background: var(--accent);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  nav {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 0.5rem;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  }

Â  Â  Â  Â  .navbtn {
Â  Â  Â  Â  Â  Â  background: #f0f0f0;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  padding: 0.6rem 1.2rem;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1rem;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  }
Â  Â  Â  Â  .navbtn:hover { background: #e0e0e0; }
Â  Â  Â  Â  .navbtn.active {
Â  Â  Â  Â  Â  Â  background: var(--accent);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border-color: var(--accent);
Â  Â  Â  Â  }

Â  Â  Â  Â  .stories-grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
Â  Â  Â  Â  Â  Â  gap: 1.5rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card {
Â  Â  Â  Â  Â  Â  background: var(--card);
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.05);
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease-in-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card:hover {
Â  Â  Â  Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 15px rgba(0,0,0,0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card img {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 180px;
Â  Â  Â  Â  Â  Â  object-fit: cover;
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card-content {
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .story-card-content h3 {
Â  Â  Â  Â  Â  Â  margin: 0 0 0.5rem;
Â  Â  Â  Â  Â  Â  color: var(--accent);
Â  Â  Â  Â  }
Â  Â  Â  Â  .story-card-content p {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  color: var(--muted);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Modal Styles */
Â  Â  Â  Â  .modal-overlay {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.7);
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-overlay.active {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 700px;
Â  Â  Â  Â  Â  Â  max-height: 90vh;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 2rem;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-close-btn {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 1rem;
Â  Â  Â  Â  Â  Â  right: 1rem;
Â  Â  Â  Â  Â  Â  background: #eee;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  width: 30px;
Â  Â  Â  Â  Â  Â  height: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  .modal-body h2 { color: var(--accent); }

Â  Â  Â  Â  .audio-controls {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 1rem;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  background: #f0f0f0;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin: 1.5rem 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .audio-btn {
Â  Â  Â  Â  Â  Â  padding: 0.7rem 1.2rem;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-size: 1rem;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 0.5rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .play-btn { background: var(--accent); }
Â  Â  Â  Â  .stop-btn { background: var(--muted); }

Â  Â  Â  Â  .audio-btn:disabled {
Â  Â  Â  Â  Â  Â  background: #ccc;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  .loading-spinner {
Â  Â  Â  Â  Â  Â  width: 16px; height: 16px; border: 2px solid rgba(255, 255, 255, 0.3);
Â  Â  Â  Â  Â  Â  border-radius: 50%; border-top-color: #fff;
Â  Â  Â  Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes spin { to { transform: rotate(360deg); } }

Â  Â  Â  Â  #audioStatus {
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  Â  Â  color: var(--muted);
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  min-height: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #modalText {
Â  Â  Â  Â  Â  Â  white-space: pre-line;
Â  Â  Â  Â  }

Â  Â  Â  Â  .highlight-sentence {
Â  Â  Â  Â  Â  Â  background-color: var(--accent-light);
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<header>
Â  Â  <h1>Kids Fun Stories</h1>
</header>

<main>
Â  Â  <div class="controls-container">
Â  Â  Â  Â  <div class="language-selector">
Â  Â  Â  Â  Â  Â  <button class="lang-btn active" data-lang="english">English</button>
Â  Â  Â  Â  Â  Â  <button class="lang-btn" data-lang="amharic">Amharic (áŠ áˆ›áˆ­áŠ›)</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <nav id="categoryNav">
Â  Â  Â  Â  Â  Â  <button class="navbtn active" data-category="all">All Stories</button>
Â  Â  Â  Â  Â  Â  <button class="navbtn" data-category="bravery">ğŸ¦ Bravery</button>
Â  Â  Â  Â  Â  Â  <button class="navbtn" data-category="kindness">â¤ï¸ Kindness</button>
Â  Â  Â  Â  Â  Â  <button class="navbtn" data-category="friendship">ğŸ¾ Friendship</button>
Â  Â  Â  Â  </nav>
Â  Â  </div>
Â  Â  <div id="storiesGrid" class="stories-grid"></div>
</main>

<div id="storyModal" class="modal-overlay">
Â  Â  <div class="modal-content">
Â  Â  Â  Â  <button class="modal-close-btn">&times;</button>
Â  Â  Â  Â  <div class="modal-body">
Â  Â  Â  Â  Â  Â  <h2 id="modalTitle"></h2>
Â  Â  Â  Â  Â  Â  <div class="audio-controls">
Â  Â  Â  Â  Â  Â  Â  Â  <button id="playBtn" class="audio-btn play-btn"><i class="fas fa-play"></i> Listen</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="stopBtn" class="audio-btn stop-btn"><i class="fas fa-stop"></i> Stop</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <p id="audioStatus"></p>
Â  Â  Â  Â  Â  Â  <div id="modalText"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
Â  Â  // --- FULL STORY DATA RESTORED ---
Â  Â  const stories = [
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 1,
Â  Â  Â  Â  Â  Â  title: { english: "Leo the Brave Little Lion", amharic: "áˆŠá‹® á‹°á‹áˆ© áŠ áŠ•á‰ áˆ³" },
Â  Â  Â  Â  Â  Â  category: "bravery",
Â  Â  Â  Â  Â  Â  description: { english: "A small lion shows great courage", amharic: "á‰µáŠ•áˆ½ áŠ áŠ•á‰ áˆ³ á‰³áˆ‹á‰… áŒ€áŒáŠ•áŠá‰µ á‹«áˆ³á‹«áˆ" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1552410260-0fd9b577afa6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `In the sunny jungle of Golden Tree, there lived a little lion named Leo. Leo was smaller than the other lions, but he had the biggest heart of them all. He loved exploring, playing with friends, and helping anyone in need.
One bright morning, Leo was walking near the river when he heard a faint cry. "Help! Help!" the voice said. Curious, Leo followed the sound and found his friend, Tilly the turtle, stuck in a thorn bush. Her little legs couldn't free her.
All the other animals saw this, but they were too scared to come close. "The thorns are too sharp," said a monkey. "I can't help," said a giraffe.
But Leo stepped forward. "Don't worry, Tilly! I will help you!" he said. Carefully, he pulled away the thorns, one by one, until Tilly was free. Tilly hugged him tightly. "Thank you, Leo! You are brave!"
From that day on, all the animals in the jungle knew that even the smallest lion can be the bravest of all. And Leo learned that helping others is more important than being the biggest or strongest.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `á‰ á‹ˆáˆ­á‰ƒáˆ›á‹ á‹›á áŒ«áŠ« á‹áˆµáŒ¥ áˆŠá‹® á‹¨áˆšá‰£áˆ á‰µáŠ•áˆ½ áŠ áŠ•á‰ áˆ³ áŠá‰ áˆ­á¢ áˆŠá‹® áŠ¨áˆŒáˆá‰¹ áŠ áŠ•á‰ áˆ¶á‰½ á‹«áŠáˆ° áŠá‰ áˆ­á£ áŠáŒˆáˆ­ áŒáŠ• áŠ¨áˆáˆ‰áˆ á‰µáˆá‰… áˆá‰¥ áŠá‰ áˆ¨á‹á¢ áˆ˜áˆ˜áˆ­áˆ˜áˆ­ á£ áŠ¨áŒ“á‹°áŠá‰¹ áŒ‹áˆ­ áˆ˜áŒ«á‹ˆá‰µ áŠ¥áŠ“ áˆˆáˆšá‹«áˆµáˆáˆáŒˆá‹ áˆ›áŠ•áŠ›á‹áˆ áˆ°á‹ áˆ˜áˆ­á‹³á‰µ á‹­á‹ˆá‹µ áŠá‰ áˆ­á¢
áŠ áŠ•á‹µ á‰€áŠ• á‰ á‰¥áˆ©áˆ… áˆ›áˆˆá‹³ áˆŠá‹® á‰ á‹ˆáŠ•á‹™ áŠ áŒ áŒˆá‰¥ áŠ¥á‹¨áˆ„á‹° áˆ³áˆˆ á‹°áŠ«áˆ› áŒ©áŠ¸á‰µ áˆ°áˆ› á¢ "áŠ¥áˆ­á‹±áŠ! áŠ¥áˆ­á‹±áŠ!"áŠ áˆˆ á‹µáˆáá¢á‹¨áˆ›á‹ˆá‰… áŒ‰áŒ‰á‰µ á‹«áˆˆá‹ áˆŠá‹® á‹µáˆááŠ• á‰°áŠ¨á‰µáˆ áŒ“á‹°áŠ›á‹áŠ• á‰²áˆŠ áŠ¤áˆŠá‹ á‰ áŠ¥áˆ¾áˆ… á‰áŒ¥á‰‹áŒ¦ á‹áˆµáŒ¥ á‰°áŒ£á‰¥á‰† áŠ áŒˆáŠ˜á‹á¢á‰µáŠ•áŠ•áˆ½ áŠ¥áŒáˆ®á‰¿Â  áŠáƒ áˆŠá‹ˆáŒ¡áˆ‹á‰µ áŠ áˆá‰»áˆ‰áˆ á¢
áˆŒáˆá‰¹ áŠ¥áŠ•áˆµáˆ³á‰µ áˆáˆ‰ á‹­áˆ…áŠ•áŠ• áŠ á‹© á£ áŠáŒˆáˆ­ áŒáŠ• áˆˆáˆ˜á‰…áˆ¨á‰¥ á‰ áŒ£áˆ áˆáˆ©á¢ "áŠ¥áˆ¾áˆ†á‰¹ á‰ áŒ£áˆ áˆ¹áˆ áŠ“á‰¸á‹" áŠ áˆˆá‰½ á‹áŠ•áŒ€áˆ®á¢ "áˆ˜áˆ­á‹³á‰µ áŠ áˆá‰½áˆáˆ" áŠ áˆˆá‰½ á‰€áŒ­áŠ”á¢
áŠáŒˆáˆ­ áŒáŠ• áˆŠá‹® á‹ˆá‹°áŠá‰µ áˆ„á‹°á¢ "áŠ á‰µáŒ¨áŠá‰‚ á£ á‰²áˆŠ! áŠ¥áˆ¨á‹³áˆ»áˆˆáˆ!" áŠ áˆ‹á‰µá¢ á‰ áŒ¥áŠ•á‰ƒá‰„ áŠ¥áˆ¾áˆ†á‰¹áŠ• á£ áŠ áŠ•á‹µ á‰ áŠ áŠ•á‹µ á£ á‰²áˆŠ áŠ¥áˆµáŠ­á‰µáˆá‰³ á‹µáˆ¨áˆµ áŠ áŠáˆ³á¢ á‰²áˆŠ á‰ áŒ¥á‰¥á‰… áŠ á‰€áˆá‰½á‹á¢ "áŠ áˆ˜áˆ°áŒáŠ“áˆˆáˆ á£ áˆŠá‹®! á‹°á‹áˆ­ áŠáˆ…!"
áŠ¨á‹šá‹« á‰€áŠ• áŒ€áˆáˆ® á‰ áŒ«áŠ«á‹ á‹áˆµáŒ¥ á‹«áˆ‰ áˆáˆ‰áˆ áŠ¥áŠ•áˆµáˆ³á‰µ á‰µáŠ•áˆ¹ áŠ áŠ•á‰ áˆ³ áŠ¥áŠ•áŠ³ áŠ¨áˆáˆ‰áˆ á‹°á‹áˆ­ áˆ˜áˆ†áŠ‘áŠ• áŠ á‹ˆá‰á¢ áŠ¥áŠ“ áˆŠá‹® áˆŒáˆá‰½áŠ• áˆ›áŒˆá‹ á‰µáˆá‰… á‹ˆá‹­áˆ áŒ áŠ•áŠ«áˆ« áŠ¨áˆ˜áˆ†áŠ• á‹¨á‰ áˆˆáŒ  áŠ áˆµáˆáˆ‹áŒŠ áˆ˜áˆ†áŠ‘áŠ• á‰°áˆ›áˆ¨á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 2,
Â  Â  Â  Â  Â  Â  title: { english: "Mia the Kind Monkey", amharic: "áˆšá‹« á‹°áŒ“ á‹áŠ•áŒ€áˆ®" },
Â  Â  Â  Â  Â  Â  category: "kindness",
Â  Â  Â  Â  Â  Â  description: { english: "A curious monkey helps find a lost key", amharic: "áŒ‰áŒ‰á‰µ á‹«áˆˆá‹ á‹áŠ•áŒ€áˆ® á‹¨áŒ á‹ á‰áˆá áˆˆáˆ›áŒáŠ˜á‰µ á‹­áˆ¨á‹³áˆ" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1540573133985-87b6da6d54a9?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `Mia was a young monkey who loved exploring. Every morning, she swung from branch to branch, discovering new places in the jungle. One day, while playing near the riverbank, she noticed something shiny on the ground.
"What could this be?" Mia wondered. She picked it up and saw it was a golden key. She didn't know whose it was, but she wanted to help. Mia hopped from tree to tree asking her friends if it belonged to anyone.
Finally, she reached Mr. Elephant, who had lost his treasure chest key days ago. "Mia! You found it!" he exclaimed, tears of happiness in his eyes. "You are very clever and kind."
Mia felt proud. She realized that curiosity can help others, especially when you are willing to take action.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `áˆšá‹« áˆ˜áˆ˜áˆ­áˆ˜áˆ­ á‹¨áˆá‰µá‹ˆá‹µ á‹ˆáŒ£á‰µ á‹áŠ•áŒ€áˆ® áŠá‰ áˆ¨á‰½á¢ á‰ á‹¨áŒ á‹‹á‰± áŠ¨á‰…áˆ­áŠ•áŒ«á á‹ˆá‹° á‰…áˆ­áŠ•áŒ«á áŠ¥á‹¨á‹˜áˆˆáˆˆá‰½ á‰ áŒ«áŠ«á‹ á‹áˆµáŒ¥ áŠ á‹³á‹²áˆµ á‰¦á‰³á‹á‰½áŠ• á‰³áŒˆáŠ›áˆˆá‰½á¢ áŠ áŠ•á‹µ á‰€áŠ• á£ áŠ¨á‹ˆáŠ•á‹ á‹³áˆ­á‰» áŠ áŒ áŒˆá‰¥ áˆµá‰µáŒ«á‹ˆá‰µ á£ áˆ˜áˆ¬á‰µ áˆ‹á‹­ á‹¨áˆšá‹«á‰¥áˆ¨á‰€áˆ­á‰… áŠáŒˆáˆ­ áŠ á‹¨á‰½á¢
"á‹­áˆ… áˆáŠ• áˆŠáˆ†áŠ• á‹­á‰½áˆ‹áˆ?" áˆšá‹« áŠ áˆ°á‰ á‰½á¢ áŠ áŠ•áˆµá‰³ áˆµá‰µáˆ˜áˆˆáŠ¨á‰µ á‹ˆáˆ­á‰ƒáˆ› á‰áˆá áŠá‰ áˆ­á¢ á‹¨áˆ›áŠ• áŠ¥áŠ•á‹°áˆ†áŠ á‰£á‰³á‹á‰…áˆ áˆ˜áˆ­á‹³á‰µ áˆáˆˆáŒˆá‰½á¢ áˆšá‹« áŠ¨á‹›á á‹ˆá‹° á‹›á áŠ¥á‹¨á‹˜áˆˆáˆˆá‰½ áŒ“á‹°áŠá‰¿áŠ• á‹¨áˆ›áŠ• áŠ¥áŠ•á‹°áˆ†áŠ áŒ á‹¨á‰€á‰½á¢
á‰ áˆ˜áŒ¨áˆ¨áˆ»áˆá£ áŠ¨á‰€áŠ“á‰µ á‰ áŠá‰µ á‹¨áˆ€á‰¥á‰µ áˆ³áŒ¥áŠ‘áŠ• á‰áˆá á‹«áŒ£á‹áŠ• áŠ á‰¶ á‹áˆ†áŠ•áŠ• áŠ áŒˆáŠ˜á‰½á¢ "áˆšá‹«! áŠ áŒˆáŠ˜áˆ½á‹!" á‰¥áˆ á‰ á‹°áˆµá‰³ áŒ®áŠ¸á¢ "á‰ áŒ£áˆ á‰¥áˆáˆ… áŠ¥áŠ“ á‹°áŒ áŠáˆ½á¢"
áˆšá‹« áŠ©áˆ«á‰µ á‰°áˆ°áˆ›á‰µá¢ áŒ‰áŒ‰á‰µ á‰ á‰°áŒá‰£áˆ­ áˆ²á‹°áŒˆá áˆŒáˆá‰½áŠ• áˆ˜áˆ­á‹³á‰µ áŠ¥áŠ•á‹°áˆšá‰½áˆ á‰°áŒˆáŠá‹˜á‰ á‰½á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 3,
Â  Â  Â  Â  Â  Â  title: { english: "Benny the Brave Bunny", amharic: "á‰¤áŠ’ á‹°á‹áˆ© áŒ¥áŠ•á‰¸áˆ" },
Â  Â  Â  Â  Â  Â  category: "bravery",
Â  Â  Â  Â  Â  Â  description: { english: "A bunny saves a bird from danger", amharic: "áŒ¥áŠ•á‰¸áˆ á‹ˆááŠ• áŠ¨áŠ á‹°áŒ‹ á‹«á‹µáŠ“áˆ" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1518796745738-41048802f99a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `Benny loved munching on carrots in his garden, but he also had a brave heart. One sunny morning, he heard a faint chirping sound. A little bird was tangled in a net near the bushes.
Benny looked around. All the other bunnies ran away. "It looks dangerous," said one. But Benny didn't hesitate. Using his sharp teeth carefully, he nibbled the net until the bird was free.
"Thank you, Benny! You saved me!" chirped the bird happily. From that day, Benny was known as the bravest bunny in the meadow. He learned that helping friends is always worth the risk.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `á‰¤áŠ’ á‰ áŠ á‰µáŠ­áˆá‰± á‹áˆµáŒ¥ áŠ«áˆ®á‰µ áˆ˜áˆ˜áŒˆá‰¥ á‹­á‹ˆá‹µ áŠá‰ áˆ­ á£ áŠáŒˆáˆ­ áŒáŠ• á‹°á‹áˆ­ áˆá‰¥áˆ áŠá‰ áˆ¨á‹á¢ áŠ áŠ•á‹µ á€áˆá‹«áˆ› áŒ á‹‹á‰µ á£ á‹°áŠ«áˆ› á‹¨ á‹ˆá áŒ©áŠ¸á‰µ áˆ°áˆ›á¢ áŠ áŠ•á‹²á‰µ á‰µáŠ•áˆ½ á‹ˆá áŠ¨á‰áŒ¥á‰‹áŒ¦á‹á‰¹ áŠ áŒ áŒˆá‰¥ á‰ áˆ˜áˆ¨á‰¥ á‰°áŒ áˆá‹ áŠá‰ áˆ­á¢
á‰¤áŠ’ á‹™áˆªá‹«á‹áŠ• á‰°áˆ˜áˆˆáŠ¨á‰°á¢ áˆŒáˆá‰¹ áŒ¥áŠ•á‰¸áˆá‰½ áˆáˆ‰ áˆ¸áˆ¹á¢ "áŠ á‹°áŒˆáŠ› á‹­áˆ˜áˆµáˆ‹áˆ" áŠ áˆˆ áŠ áŠ•á‹±á¢ áŠáŒˆáˆ­ áŒáŠ• á‰¤áŠ’ áŠ áˆ‹áˆ˜áŠá‰³áˆá¢ áˆ¹áˆ áŒ¥áˆ­áˆ¶á‰¹áŠ• á‰ áŒ¥áŠ•á‰ƒá‰„ á‰ áˆ˜áŒ á‰€áˆ á£ á‹ˆá áŠáƒ áŠ¥áˆµáŠ­á‰µá‹ˆáŒ£ á‹µáˆ¨áˆµ áˆ˜áˆ¨á‰¡áŠ• á‰†áˆ¨áŒ á¢
"áŠ áˆ˜áˆ°áŒáŠ“áˆˆáˆ á£ á‰¤áŠ’! áŠ á‹³áŠ•áŠ¨áŠ!" á‹ˆá á‰ á‹°áˆµá‰³ áŒ®áŠ¸á‰½á¢ áŠ¨á‹šá‹« á‰€áŠ• áŒ€áˆáˆ® á‰¤áŠ’ á‰ áˆœá‹³á‹ á‹áˆµáŒ¥ á‰ áŒ£áˆ á‹°á‹áˆ­ áŒ¥áŠ•á‰¸áˆ á‰ áˆ˜á‰£áˆ á‹­á‰³á‹ˆá‰… áŠá‰ áˆ­á¢ áŒ“á‹°áŠá‰½áŠ• áˆ˜áˆ­á‹³á‰µ áˆáˆáŒŠá‹œáˆ á‹‹áŒ‹ á‹«áˆˆá‹ áˆ˜áˆ†áŠ‘áŠ• á‰°áˆ›áˆ¨á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 4,
Â  Â  Â  Â  Â  Â  title: { english: "Sparkle the Kind Fish", amharic: "áˆµá“áˆ­áŠ­áˆ á‹°áŒ‰ áŠ áˆ³" },
Â  Â  Â  Â  Â  Â  category: "kindness",
Â  Â  Â  Â  Â  Â  description: { english: "A small fish helps a stranded frog", amharic: "á‰µáŠ•áˆ½ áŠ áˆ³ á‹¨á‰°á‰¸áŒˆáˆ¨ áŠ¥áŠ•á‰áˆ«áˆªá‰µ á‹­áˆ¨á‹³áˆ" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `In a sparkling blue pond, lived Sparkle, a small fish with shimmering scales. Sparkle loved swimming and exploring every corner of the pond.
One day, Sparkle noticed a tiny frog stranded on a rock. The frog was scared. Sparkle thought quickly. "Don't worry, I'll help you!" she said.
She splashed water gently to cool the frog and nudged it carefully toward the water. The frog finally hopped safely into the pond. "Thank you, Sparkle! You are so kind!" said the frog.
Sparkle learned that even small creatures can make a big difference when they show kindness.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `á‰ áˆšá‹«á‰¥áˆ¨á‰€áˆ­á‰… áˆ°áˆ›á‹«á‹Š áŠ©áˆ¬ á‹áˆµáŒ¥ áˆµá“áˆ­áŠ­áˆ á‹¨áˆá‰µá‰£áˆ á‰µáŠ•áˆ½ áŠ áˆ³ á‰µáŠ–áˆ­ áŠá‰ áˆ­á¢ áˆµá“áˆ­áŠ­áˆ áˆ˜á‹‹áŠ˜á‰µ áŠ¥áŠ“ á‹¨áŠ©áˆ¬á‹áŠ• áŠ¥á‹«áŠ•á‹³áŠ•á‹±áŠ• áŒ¥áŒ áˆ˜áˆ˜áˆ­áˆ˜áˆ­ á‰µá‹ˆá‹µ áŠá‰ áˆ­á¢
áŠ áŠ•á‹µ á‰€áŠ• áˆµá“áˆ­áŠ­áˆ á‹µáŠ•áŒ‹á‹­ áˆ‹á‹­ á‰°á‰€áˆáŒ¦ á‹¨áˆáˆ« á‰µáŠ•áˆ½ áŠ¥áŠ•á‰áˆ«áˆªá‰µ áŠ á‹¨á‰½á¢ áˆµá“áˆ­áŠ­áˆ á‰ ááŒ¥áŠá‰µ áŠ áˆ°á‰ á‰½á¢ "áŠ á‰µáŒ¨áŠá‰… áŠ¥áˆ¨á‹³áˆƒáˆˆáˆ!" áŠ áˆˆá‰½á‹á¢
áŠ¥áŠ•á‰áˆ«áˆªá‰±áŠ• áˆˆáˆ›á‰€á‹á‰€á‹ á‹áˆƒ áˆ¨áŒ¨á‰½á‰ á‰µ áŠ¥áŠ“ á‰ áŒ¥áŠ•á‰ƒá‰„ á‹ˆá‹° á‹áˆƒá‹ áŒˆá‹á‰½á‹á¢ áŠ¥áŠ•á‰áˆ«áˆªá‰± á‰ áˆ°áˆ‹áˆ á‹ˆá‹° áŠ©áˆ¬á‹ áŒˆá‰£á¢ "áŠ áˆ˜áˆ°áŒáŠ“áˆˆáˆ áˆµá“áˆ­áŠ­áˆ! á‰ áŒ£áˆ á‹°áŒ áŠáˆ½!" áŠ áˆˆ áŠ¥áŠ•á‰áˆ«áˆªá‰±á¢
áˆµá“áˆ­áŠ­áˆ á‰µáŠ“áŠ•áˆ½ ááŒ¥áˆ¨á‰³á‰µ áŠ¥áŠ•áŠ³ á‹°áŒáŠá‰µ áˆ²á‹«áˆ³á‹© á‰µáˆá‰… áˆˆá‹áŒ¥ áˆ›áˆáŒ£á‰µ áŠ¥áŠ•á‹°áˆšá‰½áˆ‰ á‰°áˆ›áˆ¨á‰½á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 5,
Â  Â  Â  Â  Â  Â  title: { english: "Timmy and the Race", amharic: "á‰²áˆš áŠ¥áŠ“ á‹á‹µá‹µáˆ©" },
Â  Â  Â  Â  Â  Â  category: "friendship",
Â  Â  Â  Â  Â  Â  description: { english: "A slow turtle shows his own strength", amharic: "á‹áŒá‰°áŠ› áŠ¤áˆŠ á‹¨áˆ«áˆ±áŠ• áŒ¥áŠ•áŠ«áˆ¬ á‹«áˆ³á‹«áˆ" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1673632118149-95cf2136c73f?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8dHVydGxlJTIwcmFjZXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=600 ",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `Timmy was the smallest turtle in the forest. He was often teased for being slow. "You'll never win a race!" the other animals would say.
One day, there was a big race to the top of Sunny Hill. The fast rabbit zipped ahead, but soon got tired and took a nap. The other animals ran fast but got distracted.
Timmy just kept going, slow and steady. He never stopped. One by one, he passed the sleeping rabbit and the distracted animals.
To everyone's surprise, Timmy the turtle was the first to reach the top of the hill. He learned that being slow and steady can win the race.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `á‰²áˆš á‰ áŒ«áŠ«á‹ á‹áˆµáŒ¥ á‰ áŒ£áˆ á‰µáŠ•áˆ¹ áŠ¤áˆŠ áŠá‰ áˆ­á¢ á‹áŒá‰°áŠ› á‰ áˆ˜áˆ†áŠ‘ á‰¥á‹™ áŒŠá‹œ á‹­áˆ³áˆˆá‰á‰ á‰µ áŠá‰ áˆ­á¢ "á‹á‹µá‹µáˆ­ á‰ ááŒ¹áˆ áŠ á‰³áˆ¸áŠ•ááˆ!" á‹­áˆ‰á‰µ áŠá‰ áˆ­ áˆŒáˆá‰¹ áŠ¥áŠ•áˆµáˆ³á‰µá¢
áŠ áŠ•á‹µ á‰€áŠ• á‹ˆá‹° á€áˆá‹«áˆ› áŠ®áˆ¨á‰¥á‰³ áŒ«á á‰µáˆá‰… á‹á‹µá‹µáˆ­ áŠá‰ áˆ­á¢ áˆáŒ£áŠ‘ áŒ¥áŠ•á‰¸áˆ á‰ ááŒ¥áŠá‰µ áˆ„á‹°á£ áŠáŒˆáˆ­ áŒáŠ• á‰¥á‹™áˆ áˆ³á‹­á‰†á‹­ á‹°áŠ­áˆ áŠ¥áŠ•á‰…áˆá á‹ˆáˆ°á‹°á‹á¢ áˆŒáˆá‰¹ áŠ¥áŠ•áˆµáˆ³á‰µ á‰ ááŒ¥áŠá‰µ áˆ®áŒ¡ áŒáŠ• á‰µáŠ©áˆ¨á‰³á‰¸á‹ á‰°á‰ á‰³á‰°áŠá¢
á‰²áˆš áŒáŠ• á‹áŒ áŠ¥áŠ“ áŒ½áŠ‘ áˆ†áŠ– áŒ‰á‹á‹áŠ• á‰€áŒ áˆˆá¢ á‰ ááŒ¹áˆ áŠ áˆ‹á‰†áˆ˜áˆá¢ áŠ áŠ•á‹µ á‰ áŠ áŠ•á‹µá£ á‹¨á‰°áŠ›á‹áŠ• áŒ¥áŠ•á‰¸áˆ áŠ¥áŠ“ á‰µáŠ©áˆ¨á‰³á‰¸á‹ á‹¨á‰°á‰ á‰³á‰°áŠ‘á‰µáŠ• áŠ¥áŠ•áˆµáˆ³á‰µ áŠ áˆˆá‹á‰¸á‹á¢
áˆˆáˆáˆ‰áˆ á‰ áˆšá‹«áˆµá‹°áŠ•á‰… áˆáŠ”á‰³á£ á‰²áˆš áŠ¤áˆŠá‹ á‹¨áŠ®áˆ¨á‰¥á‰³á‹áŠ• áŒ«á áˆˆáˆ˜á‹µáˆ¨áˆµ á‹¨áˆ˜áŒ€áˆ˜áˆªá‹«á‹ áˆ†áŠá¢ á‹áŒ áŠ¥áŠ“ áŒ½áŠ‘ áˆ˜áˆ†áŠ• á‹á‹µá‹µáˆ©áŠ• áˆŠá‹«áˆ¸áŠ•á áŠ¥áŠ•á‹°áˆšá‰½áˆ á‰°áˆ›áˆ¨á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  id: 6,
Â  Â  Â  Â  Â  Â  title: { english: "Lulu and the Lost Star", amharic: "áˆ‰áˆ‰ áŠ¥áŠ“ á‹¨áŒ á‹á‹ áŠ®áŠ¨á‰¥" },
Â  Â  Â  Â  Â  Â  category: "friendship",
Â  Â  Â  Â  Â  Â  description: { english: "A lioness helps a friend in need", amharic: "áŠ áŠ•á‰ áˆ³ á‹¨á‰°á‰¸áŒˆáˆ¨ áŒ“á‹°áŠ›á‹‹áŠ• á‰µáˆ¨á‹³áˆˆá‰½" },
Â  Â  Â  Â  Â  Â  image: "https://images.unsplash.com/photo-1546182990-dffeafbe841d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
Â  Â  Â  Â  Â  Â  text: {
Â  Â  Â  Â  Â  Â  Â  Â  english: `Lulu the lioness loved watching the stars. One night, she saw a little star fall from the sky and land in the tall grass. The little star was crying.
"I'm lost and I can't get back home!" it sobbed. Lulu felt sad for the star. "I will help you," she said gently.
Lulu carried the little star on her back and climbed to the highest point in the jungle. "Can you see your family now?" she asked.
"Yes! I can!" the star twinkled happily. It floated back up into the sky to join the other stars. Lulu knew that a good friend always helps, no matter how big or small the problem is.`,
Â  Â  Â  Â  Â  Â  Â  Â  amharic: `áˆ‰áˆ‰ áŠ áŠ•á‰ áˆ³á‹‹ áŠ¨á‹‹áŠ­á‰¥á‰µáŠ• áˆ˜áˆ˜áˆáŠ¨á‰µ á‰µá‹ˆá‹µ áŠá‰ áˆ­á¢ áŠ áŠ•á‹µ áˆáˆ½á‰µá£ áŠ áŠ•á‹µ á‰µáŠ•áˆ½ áŠ®áŠ¨á‰¥ áŠ¨áˆ°áˆ›á‹­ á‹ˆá‹µá‰† á‰ áˆ¨áŒ…áˆ áˆ³áˆ­ á‹áˆµáŒ¥ áˆ²á‹«áˆ­á áŠ á‹¨á‰½á¢ á‰µáŠ•áˆ¹ áŠ®áŠ¨á‰¥ áŠ¥á‹«áˆˆá‰€áˆ° áŠá‰ áˆ­á¢
"áŒ áá‰»áˆˆáˆ áŠ¥áŠ“ á‹ˆá‹° á‰¤á‰´ áˆ˜áˆ˜áˆˆáˆµ áŠ áˆá‰½áˆáˆ!" á‰¥áˆ áŠ áˆˆá‰€áˆ°á¢ áˆ‰áˆ‰ áˆˆáŠ®áŠ¨á‰¡ áŠ á‹˜áŠá‰½á¢ "áŠ¥áˆ¨á‹³áˆƒáˆˆáˆ" áŠ áˆˆá‰½á‹ á‰ á‰€áˆµá‰³á¢
áˆ‰áˆ‰ á‰µáŠ•áˆ¹áŠ• áŠ®áŠ¨á‰¥ á‰ áŒ€áˆ­á‰£á‹‹ áˆ‹á‹­ á‰°áˆ¸áŠ­áˆ› á‰ áŒ«áŠ«á‹ á‹áˆµáŒ¥ á‹ˆá‹°áˆšáŒˆáŠ˜á‹ áˆ¨áŒ…áˆ™ á‰¦á‰³ á‹ˆáŒ£á‰½á¢ "áŠ áˆáŠ• á‰¤á‰°áˆ°á‰¥áˆ…áŠ• áˆ›á‹¨á‰µ á‰µá‰½áˆ‹áˆˆáˆ…?" á‰¥áˆ‹ áŒ á‹¨á‰€á‰½á‹á¢
"áŠ á‹! áŠ¥á‰½áˆ‹áˆˆáˆ!" áŠ®áŠ¨á‰¡ á‰ á‹°áˆµá‰³ áŠ áŠ•áŒ¸á‰£áˆ¨á‰€á¢ á‹ˆá‹° áˆ°áˆ›á‹­ á‰°áˆ˜áˆáˆ¶ áŠ¨áˆŒáˆá‰¹ áŠ¨á‹‹áŠ­á‰¥á‰µ áŒ‹áˆ­ á‰°á‰€áˆ‹á‰€áˆˆá¢ áˆ‰áˆ‰ áŒ¥áˆ© áŒ“á‹°áŠ› á‰½áŒáˆ© á‰µáˆá‰…áˆ á‹­áˆáŠ• á‰µáŠ•áˆ½ áˆáˆáŒŠá‹œáˆ áŠ¥áŠ•á‹°áˆšáˆ¨á‹³ áŠ á‹ˆá‰€á‰½á¢`
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  ];

Â  Â  // --- GLOBAL VARIABLES ---
Â  Â  let currentLanguage = 'english';
Â  Â  const storiesGrid = document.getElementById('storiesGrid');
Â  Â  const modal = document.getElementById('storyModal');
Â  Â  const modalTitle = document.getElementById('modalTitle');
Â  Â  const modalText = document.getElementById('modalText');
Â  Â Â 
Â  Â  // Global variable for native TTS (SpeechSynthesisUtterance)
Â  Â  let currentUtterance = null;Â 
Â  Â  let currentStoryID = null;

Â  Â  // --- FIX: A NEAT AUDIO PLAYER OBJECT TO HANDLE ALL SOUND LOGIC ---
Â  Â  const AudioPlayer = {
Â  Â  Â  Â  audioElement: new Audio(),
Â  Â  Â  Â  isPlaying: false,
Â  Â  Â  Â  isPaused: false,
Â  Â  Â  Â  isTTS: false, // Tracks if we are using native TTS or local PM3

Â  Â  Â  Â  // Helper for clearing any previous highlight (used by both TTS and MP3)
Â  Â  Â  Â  _clearHighlight() {
Â  Â  Â  Â  Â  Â  modalText.querySelectorAll('span').forEach(span => span.classList.remove('highlight-sentence'));
Â  Â  Â  Â  },

Â  Â  Â  Â  // --- Uses native TTS for English ---
Â  Â  Â  Â  _playTTS(text, lang) {
Â  Â  Â  Â  Â  Â  this.stop();Â 
Â  Â  Â  Â  Â  Â  this.isTTS = true;

Â  Â  Â  Â  Â  Â  const langCode = lang === 'english' ? 'en-US' : 'am-ET'; // Use full codes for best voice selection
Â  Â  Â  Â  Â  Â  const sentences = text.match(/[^.!?â€¦]+[.!?â€¦]*/g) || [text];
Â  Â  Â  Â  Â  Â  let sentenceIndex = 0;

Â  Â  Â  Â  Â  Â  const synth = window.speechSynthesis;
Â  Â  Â  Â  Â  Â  if (!synth) {
Â  Â  Â  Â  Â  Â  Â  Â  this.updateUI('error', 'Text-to-Speech not supported in this browser.');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Function to speak the next sentence chunk
Â  Â  Â  Â  Â  Â  const speakNext = () => {
Â  Â  Â  Â  Â  Â  Â  Â  this._clearHighlight();

Â  Â  Â  Â  Â  Â  Â  Â  if (sentenceIndex >= sentences.length || !this.isPlaying) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const sentence = sentences[sentenceIndex].trim();
Â  Â  Â  Â  Â  Â  Â  Â  if (!sentence) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sentenceIndex++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  speakNext();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Highlight the current sentence (requires the sentences to be wrapped in <span>)
Â  Â  Â  Â  Â  Â  Â  Â  const spans = modalText.querySelectorAll('span');
Â  Â  Â  Â  Â  Â  Â  Â  if (spans[sentenceIndex]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  spans[sentenceIndex].classList.add('highlight-sentence');
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance = new SpeechSynthesisUtterance(sentence);
Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance.lang = langCode;

Â  Â  Â  Â  Â  Â  Â  Â  // Find a matching voice for better quality
Â  Â  Â  Â  Â  Â  Â  Â  const voice = synth.getVoices().find(v => v.lang === langCode);
Â  Â  Â  Â  Â  Â  Â  Â  if (voice) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance.voice = voice;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance.onend = () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sentenceIndex++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  speakNext();
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  currentUtterance.onerror = (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('TTS Error:', e);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.updateUI('error', 'Error reading text.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  synth.speak(currentUtterance);
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  this.isPlaying = true;
Â  Â  Â  Â  Â  Â  this.isPaused = false;
Â  Â  Â  Â  Â  Â  speakNext();
Â  Â  Â  Â  Â  Â  this.updateUI('playing');
Â  Â  Â  Â  },

Â  Â  Â  Â  // --- FIX: Uses local PM3 for Amharic with correct path: stroy/story1.pm3 ---
Â  Â  Â  Â  _playMP3(storyID) {
Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  this.isTTS = false;

Â  Â  Â  Â  Â  Â  // FIX APPLIED HERE: Using the path structure 'stroy/story1.pm3' (singular directory, .pm3 extension)
Â  Â  Â  Â  Â  Â  const mp3Path = `stroy/story${storyID}.pm3`;
Â  Â  Â  Â  Â  Â  this.audioElement.src = mp3Path;
Â  Â  Â  Â  Â  Â  this.audioElement.load();

Â  Â  Â  Â  Â  Â  this.audioElement.onloadeddata = () => {
Â  Â  Â  Â  Â  Â  Â  Â  this.audioElement.play().catch(e => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("MP3 Playback Error:", e);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.updateUI('error', 'Error playing Amharic audio. Check file path.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  this.audioElement.onended = () => this.stop();
Â  Â  Â  Â  Â  Â  this.audioElement.onerror = () => {
Â  Â  Â  Â  Â  Â  Â  Â  // Changing error message to reflect the corrected path structure
Â  Â  Â  Â  Â  Â  Â  Â  this.updateUI('error', `Amharic audio file (${mp3Path}) not found. (404 likely)`);
Â  Â  Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  this.isPlaying = true;
Â  Â  Â  Â  Â  Â  this.isPaused = false;
Â  Â  Â  Â  Â  Â  this.updateUI('playing');
Â  Â  Â  Â  },

Â  Â  Â  Â  // --- Unified Play Function ---
Â  Â  Â  Â  play(story, lang) {
Â  Â  Â  Â  Â  Â  if (this.isPaused) {
Â  Â  Â  Â  Â  Â  Â  Â  this.resume();
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  this.stop();
Â  Â  Â  Â  Â  Â  currentStoryID = story.id;Â 

Â  Â  Â  Â  Â  Â  if (lang === 'english') {
Â  Â  Â  Â  Â  Â  Â  Â  this._playTTS(story.text.english, 'english');
Â  Â  Â  Â  Â  Â  } else if (lang === 'amharic') {
Â  Â  Â  Â  Â  Â  Â  Â  this._playMP3(story.id);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },

Â  Â  Â  Â  pause() {
Â  Â  Â  Â  Â  Â  if (!this.isPlaying) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (this.isTTS && currentUtterance) {
Â  Â  Â  Â  Â  Â  Â  Â  window.speechSynthesis.pause();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  this.audioElement.pause();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  this.isPaused = true;
Â  Â  Â  Â  Â  Â  this.isPlaying = false;
Â  Â  Â  Â  Â  Â  this.updateUI('paused');
Â  Â  Â  Â  },

Â  Â  Â  Â  resume() {
Â  Â  Â  Â  Â  Â  if (!this.isPaused) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (this.isTTS && currentUtterance) {
Â  Â  Â  Â  Â  Â  Â  Â  window.speechSynthesis.resume();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  this.audioElement.play().catch(e => this.stop());
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  this.isPaused = false;
Â  Â  Â  Â  Â  Â  this.isPlaying = true;
Â  Â  Â  Â  Â  Â  this.updateUI('playing');
Â  Â  Â  Â  },

Â  Â  Â  Â  stop() {
Â  Â  Â  Â  Â  Â  // Stop TTS if active
Â  Â  Â  Â  Â  Â  if (this.isTTS && window.speechSynthesis) {
Â  Â  Â  Â  Â  Â  Â  Â  window.speechSynthesis.cancel();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // Stop Audio element if active
Â  Â  Â  Â  Â  Â  this.audioElement.pause();
Â  Â  Â  Â  Â  Â  this.audioElement.src = "";
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  currentUtterance = null;
Â  Â  Â  Â  Â  Â  this.isPlaying = false;
Â  Â  Â  Â  Â  Â  this.isPaused = false;
Â  Â  Â  Â  Â  Â  this._clearHighlight(); // Clears highlight
Â  Â  Â  Â  Â  Â  this.updateUI('stopped');
Â  Â  Â  Â  },

Â  Â  Â  Â  updateUI(state, message = '') {
Â  Â  Â  Â  Â  Â  const playBtn = document.getElementById('playBtn');
Â  Â  Â  Â  Â  Â  const audioStatus = document.getElementById('audioStatus');

Â  Â  Â  Â  Â  Â  if (state === 'playing') {
Â  Â  Â  Â  Â  Â  Â  Â  playBtn.innerHTML = `<i class="fas fa-pause"></i> Pause`;
Â  Â  Â  Â  Â  Â  Â  Â  audioStatus.textContent = 'Playing...';
Â  Â  Â  Â  Â  Â  } else if (state === 'paused') {
Â  Â  Â  Â  Â  Â  Â  Â  playBtn.innerHTML = `<i class="fas fa-play"></i> Resume`;
Â  Â  Â  Â  Â  Â  Â  Â  audioStatus.textContent = 'Paused.';
Â  Â  Â  Â  Â  Â  } else if (state === 'error') {
Â  Â  Â  Â  Â  Â  Â  Â  Â playBtn.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Error`;
Â  Â  Â  Â  Â  Â  Â  Â  Â audioStatus.textContent = message;
Â  Â  Â  Â  Â  Â  Â  Â  Â playBtn.disabled = true;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  playBtn.innerHTML = `<i class="fas fa-play"></i> Listen`;
Â  Â  Â  Â  Â  Â  Â  Â  audioStatus.textContent = 'Ready to play.';
Â  Â  Â  Â  Â  Â  Â  Â  playBtn.disabled = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // Enable stop button only if not stopped/error
Â  Â  Â  Â  Â  Â  document.getElementById('stopBtn').disabled = (state === 'stopped' || state === 'error');
Â  Â  Â  Â  }
Â  Â  };

Â  Â  // --- UI & APP LOGIC ---

Â  Â  function renderStories(category = 'all') {
Â  Â  Â  Â  storiesGrid.innerHTML = '';
Â  Â  Â  Â  const filteredStories = category === 'all'
Â  Â  Â  Â  Â  Â  ? stories
Â  Â  Â  Â  Â  Â  : stories.filter(story => story.category === category);

Â  Â  Â  Â  filteredStories.forEach(story => {
Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  card.className = 'story-card';
Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <img src="${story.image}" alt="${story.title[currentLanguage]}">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="story-card-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>${story.title[currentLanguage]}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>${story.description[currentLanguage]}</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  card.addEventListener('click', () => openModal(story));
Â  Â  Â  Â  Â  Â  storiesGrid.appendChild(card);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function openModal(story) {
Â  Â  Â  Â  modalTitle.textContent = story.title[currentLanguage];
Â  Â  Â  Â  // Split text by sentence and wrap in <span> for highlighting (English TTS)
Â  Â  Â  Â  const text = story.text[currentLanguage];
Â  Â  Â  Â  const sentences = text.match(/[^.!?â€¦]+[.!?â€¦]*/g) || [];
Â  Â  Â  Â  modalText.innerHTML = sentences.map(s => `<span>${s.trim()}</span>`).join(' ');
Â  Â  Â  Â Â 
Â  Â  Â  Â  modal.story = story;
Â  Â  Â  Â  modal.classList.add('active');
Â  Â  Â  Â  AudioPlayer.updateUI('stopped');
Â  Â  }

Â  Â  function closeModal() {
Â  Â  Â  Â  AudioPlayer.stop();
Â  Â  Â  Â  modal.classList.remove('active');
Â  Â  }

Â  Â  // --- EVENT LISTENERS ---
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  renderStories();

Â  Â  Â  Â  document.querySelectorAll('.lang-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  // Stop audio when changing language
Â  Â  Â  Â  Â  Â  Â  Â  AudioPlayer.stop();Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('.lang-btn.active').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â  currentLanguage = btn.dataset.lang;
Â  Â  Â  Â  Â  Â  Â  Â  const activeCategory = document.querySelector('.navbtn.active')?.dataset.category || 'all';
Â  Â  Â  Â  Â  Â  Â  Â  renderStories(activeCategory);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  document.querySelectorAll('.navbtn').forEach(btn => {
Â  Â  Â  Â  Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('.navbtn.active').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â  renderStories(btn.dataset.category);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  modal.querySelector('.modal-close-btn').addEventListener('click', closeModal);
Â  Â  Â  Â  modal.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  if (e.target === modal) closeModal();
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('playBtn').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const story = modal.story;
Â  Â  Â  Â  Â  Â  if (AudioPlayer.isPlaying || AudioPlayer.isPaused) {
Â  Â  Â  Â  Â  Â  Â  Â  AudioPlayer.pause();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Pass the whole story object to play, not just the text
Â  Â  Â  Â  Â  Â  Â  Â  AudioPlayer.play(story, currentLanguage);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('stopBtn').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  AudioPlayer.stop();
Â  Â  Â  Â  });
Â  Â  });

</script>
</body>
</html>
